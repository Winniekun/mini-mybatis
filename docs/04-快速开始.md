# å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“‹ å‰ç½®å‡†å¤‡

### 1. ç¯å¢ƒè¦æ±‚
- JDK 8+
- Maven 3.x
- MySQL 5.7+
- IDEï¼ˆIDEA / Eclipseï¼‰

### 2. æ•°æ®åº“å‡†å¤‡

æ‰§è¡Œ `docs/02-æ•°æ®åº“è„šæœ¬.sql`ï¼š

```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE mybatis_learn;

-- æ‰§è¡Œå®Œæ•´è„šæœ¬åˆ›å»ºè¡¨å’Œæ’å…¥æ•°æ®
```

---

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿä½“éªŒ

### Step 1: ä¿®æ”¹æ•°æ®åº“é…ç½®

ç¼–è¾‘ `src/main/resources/mybatis-config.xml`ï¼š

```xml
<dataSource type="POOLED">
    <property name="driver" value="com.mysql.cj.jdbc.Driver"/>
    <property name="url" value="jdbc:mysql://localhost:3306/mybatis_learn"/>
    <property name="username" value="ä½ çš„ç”¨æˆ·å"/>
    <property name="password" value="ä½ çš„å¯†ç "/>
</dataSource>
```

### Step 2: è¿è¡Œæµ‹è¯•

```bash
# ç¼–è¯‘é¡¹ç›®
mvn clean compile

# è¿è¡Œæµ‹è¯•
mvn test
```

æˆ–è€…åœ¨IDEä¸­ç›´æ¥è¿è¡Œ `MybatisTest` ç±»çš„æµ‹è¯•æ–¹æ³•ã€‚

### Step 3: æŸ¥çœ‹ç»“æœ

å¦‚æœçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼Œè¯´æ˜è¿è¡ŒæˆåŠŸï¼š

```
========================================
SqlSessionFactoryåˆå§‹åŒ–å®Œæˆï¼
========================================

========== æµ‹è¯•ï¼šMapperæ¥å£ä»£ç† ==========
Mapperä»£ç†å¯¹è±¡: com.sun.proxy.$Proxy5
æŸ¥è¯¢ç»“æœ: User{id=1, username='zhangsan', ...}
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### æ–¹å¼ä¸€ï¼šSqlSessionç›´æ¥æ“ä½œï¼ˆåŸå§‹æ–¹å¼ï¼‰

```java
// 1. åˆ›å»ºSqlSessionFactory
InputStream is = Resources.getResourceAsStream("mybatis-config.xml");
SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(is);

// 2. è·å–SqlSession
SqlSession session = factory.openSession();

// 3. æ‰§è¡ŒSQL
User user = session.selectOne(
    "com.mybatis.test.mapper.UserMapper.selectById", 1L);

// 4. å…³é—­ä¼šè¯
session.close();
```

### æ–¹å¼äºŒï¼šMapperæ¥å£ï¼ˆæ¨èæ–¹å¼ï¼‰

```java
// 1. åˆ›å»ºSqlSessionFactory
InputStream is = Resources.getResourceAsStream("mybatis-config.xml");
SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(is);

// 2. è·å–SqlSession
SqlSession session = factory.openSession();

// 3. è·å–Mapper
UserMapper mapper = session.getMapper(UserMapper.class);

// 4. è°ƒç”¨æ–¹æ³•
User user = mapper.selectById(1L);
List<User> users = mapper.selectAll();

// 5. å…³é—­ä¼šè¯
session.close();
```

### å®Œæ•´ç¤ºä¾‹ï¼ˆæ¨èä½¿ç”¨try-with-resourcesï¼‰

```java
InputStream is = Resources.getResourceAsStream("mybatis-config.xml");
SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(is);

try (SqlSession session = factory.openSession()) {
    UserMapper mapper = session.getMapper(UserMapper.class);
    
    // æŸ¥è¯¢
    User user = mapper.selectById(1L);
    System.out.println(user);
    
    // æ’å…¥
    User newUser = new User();
    newUser.setUsername("newuser");
    newUser.setPassword("123456");
    newUser.setEmail("new@example.com");
    newUser.setCreateTime(new Date());
    
    int rows = mapper.insert(newUser);
    
    // æäº¤äº‹åŠ¡
    session.commit();
}
```

---

## ğŸ”§ é¡¹ç›®ç»“æ„

```
mini-mybatis/
â”œâ”€â”€ src/main/java/com/mybatis/
â”‚   â”œâ”€â”€ session/          # ä¼šè¯å±‚ï¼ˆSqlSessionã€SqlSessionFactoryï¼‰
â”‚   â”œâ”€â”€ executor/         # æ‰§è¡Œå™¨å±‚ï¼ˆExecutorã€StatementHandlerï¼‰
â”‚   â”œâ”€â”€ mapping/          # æ˜ å°„å±‚ï¼ˆMappedStatementï¼‰
â”‚   â”œâ”€â”€ builder/          # æ„å»ºå™¨ï¼ˆXMLè§£æï¼‰
â”‚   â”œâ”€â”€ binding/          # ç»‘å®šå±‚ï¼ˆMapperä»£ç†ï¼‰
â”‚   â”œâ”€â”€ plugin/           # æ’ä»¶å±‚ï¼ˆæ‹¦æˆªå™¨ï¼‰
â”‚   â”œâ”€â”€ cache/            # ç¼“å­˜å±‚
â”‚   â”œâ”€â”€ io/               # IOå·¥å…·
â”‚   â””â”€â”€ exceptions/       # å¼‚å¸¸
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ mybatis-config.xml        # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ mapper/                   # Mapperæ˜ å°„æ–‡ä»¶
â”‚   â””â”€â”€ logback.xml              # æ—¥å¿—é…ç½®
â”œâ”€â”€ src/test/java/com/mybatis/test/
â”‚   â”œâ”€â”€ entity/           # å®ä½“ç±»
â”‚   â”œâ”€â”€ mapper/           # Mapperæ¥å£
â”‚   â””â”€â”€ MybatisTest.java  # æµ‹è¯•ç±»
â””â”€â”€ docs/                 # æ–‡æ¡£
```

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µé€ŸæŸ¥

### SqlSessionFactory
- **ä½œç”¨**ï¼šåˆ›å»ºSqlSessionçš„å·¥å‚
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šåº”ç”¨çº§åˆ«ï¼Œå…¨å±€å”¯ä¸€
- **åˆ›å»ºæ–¹å¼**ï¼šé€šè¿‡SqlSessionFactoryBuilder.build()

### SqlSession
- **ä½œç”¨**ï¼šæ‰§è¡ŒSQLã€è·å–Mapperã€ç®¡ç†äº‹åŠ¡
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šè¯·æ±‚çº§åˆ«ï¼Œç”¨å®Œå³å…³
- **çº¿ç¨‹å®‰å…¨**ï¼šä¸å®‰å…¨ï¼Œä¸èƒ½å…±äº«

### Mapperæ¥å£
- **ä½œç”¨**ï¼šå®šä¹‰æ•°æ®åº“æ“ä½œæ–¹æ³•
- **å®ç°æ–¹å¼**ï¼šJDKåŠ¨æ€ä»£ç†ï¼Œæ— éœ€å®ç°ç±»
- **æ–¹æ³•æ˜ å°„**ï¼šé€šè¿‡namespace.æ–¹æ³•åæ‰¾åˆ°SQL

### Configuration
- **ä½œç”¨**ï¼šMyBatisçš„å…¨å±€é…ç½®ä¸­å¿ƒ
- **å†…å®¹**ï¼šæ•°æ®æºã€Mapperã€æ’ä»¶ã€ç¼“å­˜ç­‰
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šåº”ç”¨çº§åˆ«

### Executor
- **ä½œç”¨**ï¼šSQLæ‰§è¡Œå™¨
- **ç±»å‹**ï¼šSimpleã€Reuseã€Batch
- **èŒè´£**ï¼šæ‰§è¡ŒSQLã€ç®¡ç†äº‹åŠ¡ã€å¤„ç†ç¼“å­˜

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. è¿æ¥æ•°æ®åº“å¤±è´¥

**ç°è±¡**ï¼š
```
com.mybatis.exceptions.MyBatisException: è·å–æ•°æ®åº“è¿æ¥å¤±è´¥
```

**è§£å†³**ï¼š
- æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å¯åŠ¨
- æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æ•°æ®åº“URLæ˜¯å¦æ­£ç¡®
- æ£€æŸ¥MySQLé©±åŠ¨ç‰ˆæœ¬

### 2. Mapperæœªæ³¨å†Œ

**ç°è±¡**ï¼š
```
com.mybatis.exceptions.MyBatisException: Mapperæœªæ³¨å†Œ
```

**è§£å†³**ï¼š
- æ£€æŸ¥Mapper.xmlçš„namespaceæ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æ˜¯å¦åœ¨mybatis-config.xmlä¸­é…ç½®äº†mapper
- æ£€æŸ¥Mapperæ¥å£çš„åŒ…åå’Œç±»åæ˜¯å¦ä¸namespaceä¸€è‡´

### 3. SQLæ‰§è¡Œå¤±è´¥

**ç°è±¡**ï¼š
```
java.sql.SQLException: ...
```

**è§£å†³**ï¼š
- æ£€æŸ¥SQLè¯­å¥æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥è¡¨åã€å­—æ®µåæ˜¯å¦å­˜åœ¨
- æ£€æŸ¥å‚æ•°ç±»å‹æ˜¯å¦åŒ¹é…
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„å®Œæ•´SQL

### 4. ç»“æœæ˜ å°„å¤±è´¥

**ç°è±¡**ï¼š
- æŸ¥è¯¢è¿”å›null
- å­—æ®µå€¼ä¸ºnull

**è§£å†³**ï¼š
- æ£€æŸ¥resultTypeæ˜¯å¦æ­£ç¡®
- æ£€æŸ¥å®ä½“ç±»æ˜¯å¦æœ‰getter/setter
- æ£€æŸ¥å­—æ®µåä¸å±æ€§åæ˜¯å¦åŒ¹é…ï¼ˆæ”¯æŒä¸‹åˆ’çº¿â†”é©¼å³°è½¬æ¢ï¼‰

---

## ğŸ“– å­¦ä¹ è·¯çº¿

### åˆå­¦è€…ï¼ˆç¬¬1å‘¨ï¼‰
1. âœ… è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼ŒéªŒè¯åŠŸèƒ½
2. âœ… ç†è§£é¡¹ç›®ç»“æ„
3. âœ… å­¦ä¹ åŸºæœ¬ä½¿ç”¨æ–¹å¼
4. âœ… é˜…è¯»README.md

### è¿›é˜¶ï¼ˆç¬¬2-3å‘¨ï¼‰
1. âœ… é˜…è¯»æ ¸å¿ƒç±»çš„æºç 
2. âœ… ç†è§£è®¾è®¡æ¨¡å¼çš„åº”ç”¨
3. âœ… å¯¹æ¯”çœŸå®MyBatisæºç 
4. âœ… å°è¯•æ‰©å±•åŠŸèƒ½

### é«˜çº§ï¼ˆç¬¬4å‘¨åŠä»¥åï¼‰
1. âœ… é˜…è¯»çœŸå®MyBatisæºç 
2. âœ… ç ”ç©¶é«˜çº§ç‰¹æ€§ï¼ˆç¼“å­˜ã€æ’ä»¶ã€åŠ¨æ€SQLï¼‰
3. âœ… å­¦ä¹ MyBatis-Plus
4. âœ… é¡¹ç›®å®æˆ˜åº”ç”¨

---

## ğŸ“ ä¸‹ä¸€æ­¥

1. **é˜…è¯»æ–‡æ¡£**ï¼š`docs/01-é¡¹ç›®ä»‹ç».md`
2. **æºç å­¦ä¹ **ï¼šä»SqlSessionFactoryçš„åˆ›å»ºå¼€å§‹
3. **è°ƒè¯•ä»£ç **ï¼šæ‰“æ–­ç‚¹ï¼Œè·Ÿè¸ªå®Œæ•´æµç¨‹
4. **å¯¹æ¯”æºç **ï¼š`docs/03-æºç å¯¹æ¯”åˆ†æ.md`
5. **é¢è¯•å‡†å¤‡**ï¼šæ•´ç†çŸ¥è¯†ç‚¹ï¼Œå‡†å¤‡é¢è¯•

---

## ğŸ’¬ åé¦ˆ

å¦‚æœé‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œæ¬¢è¿æIssueï¼

---

**Happy Learning! ğŸ‰**

